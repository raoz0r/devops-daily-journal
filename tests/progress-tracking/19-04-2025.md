---
tags:
- devops
- python
- taglog
- newlog
- grafana-alloy
---

# 19-04-2025

#devops #python #taglog #newlog #grafana-alloy <!-- markdownlint-disable-line MD018 -->

## 🌟 Daily Goals

### Priority 1

- [x] Improve the logging system moving from bash to python
- [x] Update the taglog.logs script to look for changes in the tags
- [ ] Migrate promtail to Grafana Alloy.

### Priority 2

- [ ] Tweak cAdvisor a bit, using too much resources
- [ ] Automate backups with a script
- [ ] Adding Resource tracking in Grafana for my scripts

### Priority Someday

- [ ] Serve your own static site via Nginx
- [ ] Possibly try watchtower or portainer if you're going wild

## 📑 Work Log

## 🧠 Insights & Decisions

### Moving script to python

The decision to migrate the logging and tagging scripts from Bash to Python was made to leverage Python's extensive library ecosystem and built-in functionalities. Python provides better support for handling YAML, structured data, and complex operations, making it a more scalable and maintainable choice for future enhancements. This transition will simplify development and improve the overall efficiency of the scripts.

## 👨🏽‍💻 Troubleshooting 🕵️

## 🧰 Tools 📓 📝<!-- markdownlint-disable MD024 -->

### 📓 Bash Script Heading Sample

#### Purpose

#### Key Features

##### 1. Automatic File Naming

##### 2. Pre-Filled Template

##### 3. Logging

##### 4. Integration with CLI

#### Workflow

##### 1. File Creation

##### 2. Logging the Event

##### 3. User Notification

#### Example Use Case

#### Notes

### 📓 Taglog Script

#### Purpose

Automatically manage and update metadata tags in Obsidian-compatible Markdown files.  
This script injects YAML front matter based on inline hashtags and tracks any changes in a centralized log, supporting structured observability for personal logs or DevOps documentation.

#### Key Features

##### 1. Automatic File Naming

- Operates on `.md` files modified in the last 24 hours within a specified directory.

##### 2. Pre-Filled Template

- If no YAML front matter is present, it extracts inline `#tags` from line 3 and injects them as a properly formatted YAML list.

##### 3. Logging

- Appends structured log entries to `taglog.log` for every operation:
  - `tag_injected` for newly created tags
  - `tag_updated` when tags change
  - `tag_skipped` when skipping malformed or untaggable files

##### 4. Integration with CLI

- Can be used in cron jobs or shell scripts with no external interaction.
- Simple to integrate into pipelines or other automation workflows.

#### Workflow

##### 1. File Creation

- Walks the target directory recursively.
- Identifies markdown files modified in the last 24 hours.

##### 2. Logging the Event

- Logs follow this format:  
  `level=<level> event=<event> file=<file_name> [reason=<reason>] [tags=<tags>]`

- Example:  
  `2025-04-19T13:00:00 level=info event=tag_injected file=19-04-2025.md tags=docker,devops,loki`

##### 3. User Notification

- No terminal output unless integrated with other scripts — logging happens silently.
- Errors are logged instead of thrown to the user.

#### Example Use Case

You’ve written a daily log in Obsidian and added inline hashtags like:

```markdown
# 19.04.2025  
#docker #grafana #promtail
```

The script will detect no front matter, extract the hashtags, and transform your file into:

```markdown
---
tags:
  - docker
  - grafana
  - promtail
---

# 19.04.2025  
#docker #grafana #promtail
```

A log entry is created:

```log
2025-04-19T13:00:00 level=info event=tag_injected file=19-04-2025.md tags=docker,grafana,promtail
```

#### Notes

- Uses **PyYAML** for parsing and formatting.
- Will **not** overwrite existing tag entries unless malformed.
- Validates tag changes by comparing current YAML with the latest log entry.
- Rejects files with:
  - No tags
  - Invalid or malformed YAML
  - Errors during read/write
- Aimed at **personal observability**, not enterprise-scale nonsense.
- It compares the current day with the file and if the name is the same add a entry with event=daily_log_finalized

### 📓 `newlog.py` — Daily Markdown Log Initializer

#### Purpose

Automatically creates a pre-formatted Markdown file for the current date, serving as the foundation for daily tracking and structured journaling in Obsidian or any markdown-based workflow. It also logs the creation event for observability and retrospection.

#### Key Features

##### 1. Automatic File Naming

Creates a file named with the current date in `DD-MM-YYYY.md` format, ensuring consistency and time-based sorting.

##### 2. Pre-Filled Template

Populates the new file with a structured markdown template that includes:

- Daily goals
- Work log
- Troubleshooting
- Tool tracking
- A sample script documentation block
- Planning for the next day

##### 3. Logging

Writes a timestamped `event=daily_log_initialized` entry to a shared log file (`taglog.log`) for historical tracking of file creation events.

##### 4. Integration with CLI

Can be symlinked to `~/bin` and invoked via terminal using `newlog`, making it part of your daily dev ritual.

#### Workflow

##### 1. File Creation

Generates a file with today’s date and fills it with structured sections to encourage clear and consistent journaling.

##### 2. Logging the Event

Appends an ISO-formatted log line to the shared log file with the created filename and event name.

##### 3. User Notification

Prints clear feedback to the terminal about the creation success or failure, and confirms log file update.

#### Example Use Case

You're starting your workday. You run `newlog`, and boom — a fully structured daily log appears, named `DD-MM-YYYY.md`. It includes all the relevant sections to help you focus, reflect, and document your progress. And now it's tracked in your `DD-MM-YYYY.md`.

#### Notes

- Will **not overwrite** existing files.
- Requires Python 3 and `taglog.log` directory structure to exist or be creatable.
- Can be extended to also log `event=daily_log_finished` based on workflow closure.
- Symlink tip: `ln -s /path/to/newlog.py ~/bin/newlog && chmod +x newlog.py`

📝 *“Because your brain deserves a markdown canvas — not a post-it note.”*

## 🗃️  Step-by-Step Guide 🛠️ ⚙️

## 🔗 Resources

[PyYaml Documentation](https://pyyaml.org/wiki/PyYAMLDocumentation)
[Grafana Alloy Components](https://grafana.com/docs/alloy/latest/get-started/components/)

## 🗓️ Next Day Preview
